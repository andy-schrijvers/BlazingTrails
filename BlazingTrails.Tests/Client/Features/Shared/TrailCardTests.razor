

@inherits TestContext

@code {


    private readonly TestAuthorizationContext _authContext;
    private readonly Fixture _fixture;

    public TrailCardTests()
    {
        this.AddBlazoredLocalStorage();
        this.Services.AddScoped<AppState>();
        _authContext = this.AddTestAuthorization();
    }

    [Fact]
    public void RendersEditButton_When_UserIsAuthorized()
    {
        //Arrange
        var authorizedUser = "Test user";
        _authContext.SetAuthorized(authorizedUser);
        _authContext.SetRoles("Administrator");

        var testTrail = _fixture.Create<Trail>();
        testTrail.Owner = authorizedUser;

        //Act
        var cut = Render
        (
            @<TrailCard Trail="testTrail" OnSelected="@(() => OnSelect(testTrail))"/>
        );

        //Assert
        var editButton = cut.Find("button[title=\"Edit\"]");
        Assert.NotNull(editButton);
    }

    private Trail OnSelect(Trail trail)
    {
        return trail;
    }
}
